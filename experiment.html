<!DOCTYPE html>
<html>
  <head>
    <title>Group 4 Experiment</title>
    <link rel="icon" type="image/x-icon" href="mag.png">
    <script src="jspsych/jspsych.js"></script>
    <script src="jspsych/plugin-html-keyboard-response.js"></script>
    <script src="jspsych/plugin-instructions.js"></script>
    <script src="jspsych/plugin-image-slider-response.js"></script>
    <script src="plugin-custom-deblur-pilot.js"></script>
    <script src="plugin-custom-deblur.js"></script>
    <script src="jspsych/plugin-canvas-slider-response.js"></script>
    <script src="jspsych/plugin-preload.js"></script>
    <link href="jspsych/jspsych.css" rel="stylesheet" type="text/css" />
  </head>
  <body></body>
  <script>
    const jsPsych = initJsPsych({
        // show_progress_bar: true,
        on_finish: function() {
        jsPsych.data.displayData();
        }
    });

    const subject_id = jsPsych.randomization.randomID(10);
    const filename = `${subject_id}.csv`;

    
    const images = [  ["images/animal.jpg", 4],
                      ["images/bamboo.jpg", 2],
                      ["images/begonia.jpg", 2],
                      ["images/books.jpg", 7],
                      ["images/bridge.jpg", 1],
                      ["images/buildings.jpg", 5],
                      ["images/coffee.jpg", 4],
                      ["images/comp.jpg", 1],
                      ["images/cow.jpg", 4],
                      ["images/deer.jpg", 3],
                    //  ["images/doc.jpg", 1],
                      ["images/flower.jpg", 7],
                      ["images/food.jpg", 5],
                      ["images/girl.jpg", 3],
                      ["images/goalie.jpg", 3],
                      ["images/goose.jpg", 3],
                      ["images/icecream.jpg", 4],
                      ["images/lightbulb.jpg", 4],
                      ["images/lion.jpg", 2],
                    //  ["images/monks.jpg", 1],
                      ["images/mountains.jpg", 5],
                      ["images/owl.jpg", 5],
                      ["images/road.jpg", 5],
                    //  ["images/ropes.jpg", 0],
                      ["images/sea.jpg", 1],
                      ["images/spider.jpg", 1],
                      ["images/toast.jpg", 2],
                      ["images/terraces.jpg", 1],
                      ["images/water.jpg", 3],
                      ["images/weightlifting.jpg", 5]
                    ]

    var timeline = [];

    const shuffledImages = jsPsych.randomization.shuffle(images);

    const stimList = [];

    for (i = 0; i < shuffledImages.length; i+=3){
      const stim = {
        image1: shuffledImages[i][0],
        blur1: shuffledImages[i][1],
        image2: shuffledImages[i + 1][0],
        blur2: shuffledImages[i + 1][1],
        image3: shuffledImages[i + 2][0],
        blur3: shuffledImages[i + 1][1]
      };
      stimList.push(stim);
    }

    var instructions = {
      type: jsPsychInstructions,
      pages: [
      `Welcome! Click <strong>NEXT</strong> to begin.` +
      '<br>' +
      '<br>',

      'In the following task, you will be shown 3 images at a time.' +
      '<br>' +
      '<br>' +
      `The images are blurred -- you have the ability to deblur them by using one of your clicks.` +
      '<br>' +
      '<br>' +
      `Then, please describe the image in one or two words.` +
      '<br>' +
      '<br>',

      `There are a total of 27 images, although you can end early if you wish.` +
      '<br>' +
      '<br>' +
      `You'll have the option to end the experiment after each trial.` +
      '<br>' +
      '<br>',

      `Please take your time during the deblur process.` +
      '<br>' +
      '<br>' +
      `The button will become disabled immediately
       after clicking to prevent you from clicking too quickly.` +
      '<br>' +
      '<br>',

      `Ready to begin?` +
      '<br>' +
      '<br>'
      ],
      show_clickable_nav: true
    }

    timeline.push(instructions);

    var blur_trials = {
      type: jsPsychCustomDeblur,
      timeline: [
        { stim: stimList[0],
          stim: stimList[1],
          stim: stimList[2],
          stim: stimList[3],
          stim: stimList[4],
          stim: stimList[5],
          stim: stimList[6],
          stim: stimList[7],
          stim: stimList[8]
        }
      ]
    }

    timeline.push(blur_trials);

    jsPsych.run(timeline);
</script>
</html>
